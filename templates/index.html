<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI OCT Disease Analyzer</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700;900&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #5761B2;
            --secondary: #3B9FB5;
            --accent: #1FC5A8;
            --gradient-main: linear-gradient(135deg, #5761B2 0%, #3B9FB5 50%, #1FC5A8 100%);
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(-45deg, #5761B2, #3B9FB5, #1FC5A8, #26D0B8);
            background-size: 400% 400%;
            animation: gradientBG 15s ease infinite;
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* Particle Background */
        #particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
        }

        .particle {
            position: absolute;
            width: 3px;
            height: 3px;
            background: rgba(255, 255, 255, 0.5);
            border-radius: 50%;
            animation: float 20s infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0) translateX(0); opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { transform: translateY(-1000px) translateX(100px); opacity: 0; }
        }

        /* Glass Container */
        .container {
            position: relative;
            z-index: 1;
            max-width: 1600px;
            margin: 40px auto;
            padding: 40px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            border-radius: 30px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.2);
        }

        /* Header with 3D Text */
        .header {
            text-align: center;
            margin-bottom: 60px;
            perspective: 1000px;
        }

        h1 {
            font-size: 4em;
            font-weight: 900;
            background: linear-gradient(45deg, #fff, #1FC5A8, #5761B2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 10px 30px rgba(0,0,0,0.3);
            animation: titleGlow 3s ease-in-out infinite;
            transform: rotateX(10deg);
        }

        @keyframes titleGlow {
            0%, 100% { filter: brightness(1); }
            50% { filter: brightness(1.3); }
        }

        .subtitle {
            color: rgba(255, 255, 255, 0.9);
            font-size: 1.4em;
            margin-top: 15px;
            font-weight: 300;
            letter-spacing: 2px;
        }

        /* Stats Counter */
        .stats-bar {
            display: flex;
            justify-content: center;
            margin-bottom: 50px;
            gap: 30px;
        }

        .stat-card {
            flex: 1;
            max-width: 400px;
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            padding: 30px;
            border-radius: 20px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        .stat-card:hover {
            transform: translateY(-10px) scale(1.05);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        }

        .stat-number {
            font-size: 3em;
            font-weight: 900;
            color: white;
            text-shadow: 0 0 20px rgba(255, 255, 255, 0.5);
        }

        .stat-label {
            color: rgba(255, 255, 255, 0.8);
            font-size: 1.1em;
            margin-top: 10px;
        }

        /* Upload Zone with Hologram Effect */
        .upload-zone {
            position: relative;
            padding: 80px;
            border: 3px dashed rgba(255, 255, 255, 0.5);
            border-radius: 25px;
            background: rgba(255, 255, 255, 0.05);
            text-align: center;
            cursor: pointer;
            overflow: hidden;
            transition: all 0.4s;
            margin-bottom: 60px;
        }

        .upload-zone::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: conic-gradient(
                transparent, 
                rgba(31, 197, 168, 0.4), 
                transparent 30%
            );
            animation: rotate 4s linear infinite;
        }

        @keyframes rotate {
            100% { transform: rotate(360deg); }
        }

        .upload-zone::after {
            content: '';
            position: absolute;
            inset: 3px;
            background: rgba(26, 26, 46, 0.8);
            backdrop-filter: blur(20px);
            border-radius: 22px;
            z-index: 0;
        }

        .upload-zone:hover {
            border-color: rgba(31, 197, 168, 0.8);
            transform: scale(1.02);
            box-shadow: 0 0 50px rgba(31, 197, 168, 0.5);
        }

        .upload-content {
            position: relative;
            z-index: 1;
        }

        .upload-icon {
            font-size: 5em;
            margin-bottom: 20px;
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-20px); }
        }

        .upload-text {
            color: white;
            font-size: 1.8em;
            font-weight: 600;
            margin-bottom: 15px;
        }

        .upload-btn {
            background: var(--gradient-main);
            color: white;
            padding: 20px 50px;
            border: none;
            border-radius: 50px;
            font-size: 1.2em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 10px 30px rgba(87, 97, 178, 0.4);
            position: relative;
            overflow: hidden;
        }

        .upload-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .upload-btn:hover::before {
            width: 300px;
            height: 300px;
        }

        .upload-btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(87, 97, 178, 0.6);
        }

        /* Loading with DNA Helix */
        .loading {
            display: none;
            text-align: center;
            margin: 60px 0;
        }

        .dna-helix {
            width: 100px;
            height: 100px;
            margin: 0 auto 30px;
            position: relative;
        }

        .dna-strand {
            position: absolute;
            width: 10px;
            height: 10px;
            background: white;
            border-radius: 50%;
            box-shadow: 0 0 20px rgba(31, 197, 168, 0.8);
        }

        .dna-strand:nth-child(1) { animation: dna 2s infinite 0s; }
        .dna-strand:nth-child(2) { animation: dna 2s infinite 0.2s; }
        .dna-strand:nth-child(3) { animation: dna 2s infinite 0.4s; }
        .dna-strand:nth-child(4) { animation: dna 2s infinite 0.6s; }
        .dna-strand:nth-child(5) { animation: dna 2s infinite 0.8s; }

        @keyframes dna {
            0%, 100% { 
                transform: translateX(-30px) translateY(0) scale(1);
                opacity: 0.3;
            }
            50% { 
                transform: translateX(30px) translateY(50px) scale(1.5);
                opacity: 1;
            }
        }

        .loading-text {
            color: white;
            font-size: 1.5em;
            font-weight: 600;
            animation: pulse 1.5s infinite;
        }

        /* Results with 3D Cards */
        .results {
            display: none;
        }

        /* Holographic Speedometer */
        .speedometer-section {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            border-radius: 30px;
            padding: 50px;
            margin-bottom: 50px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            position: relative;
            overflow: hidden;
        }

        .speedometer-section::before {
            content: '';
            position: absolute;
            width: 500px;
            height: 500px;
            background: radial-gradient(circle, rgba(31, 197, 168, 0.3), transparent);
            top: -250px;
            right: -250px;
            animation: pulse 3s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 0.5; }
            50% { transform: scale(1.1); opacity: 0.8; }
        }

        .speedometer-title {
            text-align: center;
            color: white;
            font-size: 2em;
            font-weight: 700;
            margin-bottom: 40px;
            text-shadow: 0 0 20px rgba(255, 255, 255, 0.5);
        }

        .speedometer {
            position: relative;
            width: 350px;
            height: 175px;
            margin: 0 auto;
        }

        .gauge-svg {
            width: 100%;
            height: 100%;
        }

        .gauge-bg {
            fill: none;
            stroke: rgba(255, 255, 255, 0.2);
            stroke-width: 20;
        }

        .gauge-progress {
            fill: none;
            stroke: url(#gradient);
            stroke-width: 20;
            stroke-linecap: round;
            transition: stroke-dashoffset 2s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            filter: drop-shadow(0 0 20px rgba(31, 197, 168, 0.8));
        }

        .needle {
            position: absolute;
            width: 5px;
            height: 140px;
            background: linear-gradient(to top, #fff, #1FC5A8);
            bottom: 0;
            left: 50%;
            transform-origin: bottom center;
            transform: translateX(-50%) rotate(-90deg);
            transition: transform 2.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            border-radius: 3px 3px 0 0;
            box-shadow: 0 0 20px rgba(31, 197, 168, 0.8);
        }

        .needle-center {
            position: absolute;
            width: 25px;
            height: 25px;
            background: radial-gradient(circle, #fff, #1FC5A8);
            border-radius: 50%;
            bottom: -12px;
            left: 50%;
            transform: translateX(-50%);
            box-shadow: 0 0 30px rgba(31, 197, 168, 1);
            animation: pulse 2s infinite;
        }

        .confidence-display {
            text-align: center;
            margin-top: 40px;
        }

        .confidence-number {
            font-size: 5em;
            font-weight: 900;
            color: white;
            text-shadow: 0 0 40px rgba(255, 255, 255, 0.8);
            animation: numberPulse 2s infinite;
        }

        @keyframes numberPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .prediction-badge {
            display: inline-block;
            margin-top: 30px;
            padding: 25px 60px;
            background: var(--gradient-main);
            border-radius: 60px;
            font-size: 2.5em;
            font-weight: 900;
            color: white;
            text-transform: uppercase;
            letter-spacing: 3px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
            animation: glow 2s infinite;
        }

        @keyframes glow {
            0%, 100% { 
                box-shadow: 0 20px 60px rgba(87, 97, 178, 0.4);
                transform: translateY(0);
            }
            50% { 
                box-shadow: 0 25px 70px rgba(31, 197, 168, 0.8);
                transform: translateY(-5px);
            }
        }

        /* 3D Floating Image Cards */
        .images-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 40px;
            margin: 60px 0;
            perspective: 1000px;
        }

        .image-card-3d {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(15px);
            border-radius: 25px;
            padding: 25px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            transform-style: preserve-3d;
        }

        .image-card-3d:hover {
            transform: rotateY(10deg) translateY(-15px);
            box-shadow: 0 30px 80px rgba(0, 0, 0, 0.4);
        }

        .image-card-3d img {
            width: 100%;
            border-radius: 15px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .image-card-title {
            color: white;
            font-size: 1.4em;
            font-weight: 700;
            margin-bottom: 10px;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
        }

        .image-card-desc {
            color: rgba(255, 255, 255, 0.7);
            font-size: 1em;
        }

        /* Circular Progress Bars for Probabilities */
        .probabilities-section {
            margin: 60px 0;
        }

        .section-title {
            text-align: center;
            color: white;
            font-size: 2.5em;
            font-weight: 700;
            margin-bottom: 50px;
            text-shadow: 0 0 20px rgba(255, 255, 255, 0.5);
        }

        .probabilities-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 30px;
        }

        .prob-circle {
            text-align: center;
            transform: scale(0);
            animation: scaleIn 0.6s forwards;
        }

        .prob-circle:nth-child(1) { animation-delay: 0.1s; }
        .prob-circle:nth-child(2) { animation-delay: 0.2s; }
        .prob-circle:nth-child(3) { animation-delay: 0.3s; }
        .prob-circle:nth-child(4) { animation-delay: 0.4s; }

        .circle-container {
            position: relative;
            width: 200px;
            height: 200px;
            margin: 0 auto 20px;
        }

        .circle-bg, .circle-progress {
            fill: none;
            stroke-width: 15;
        }

        .circle-bg {
            stroke: rgba(255, 255, 255, 0.2);
        }

        .circle-progress {
            stroke-linecap: round;
            transition: stroke-dashoffset 1.5s ease-out;
            filter: drop-shadow(0 0 15px currentColor);
        }

        .circle-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
        }

        .circle-percentage {
            font-size: 2.5em;
            font-weight: 900;
            color: white;
            text-shadow: 0 0 20px rgba(255, 255, 255, 0.8);
        }

        .circle-label {
            color: white;
            font-size: 1.2em;
            font-weight: 600;
            margin-top: 15px;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        /* Animated Feature Bars */
        .features-section {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(15px);
            border-radius: 25px;
            padding: 50px;
            margin: 60px 0;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .feature-item {
            margin: 30px 0;
        }

        .feature-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
        }

        .feature-name {
            color: white;
            font-size: 1.3em;
            font-weight: 600;
        }

        .feature-value {
            color: rgba(255, 255, 255, 0.9);
            font-size: 1.2em;
            font-weight: 700;
        }

        .feature-bar-container {
            height: 35px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            overflow: hidden;
            position: relative;
        }

        .feature-bar-fill {
            height: 100%;
            border-radius: 20px;
            transition: width 1.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            position: relative;
            overflow: hidden;
        }

        .feature-bar-fill::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        /* Medical Insights Section */
        .medical-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(15px);
            border-radius: 25px;
            padding: 50px;
            margin-bottom: 40px;
            border: 2px solid rgba(255, 255, 255, 0.2);
        }

        .info-card {
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 35px;
            transition: transform 0.3s;
        }

        .info-card:hover {
            transform: translateY(-5px);
        }

        .info-card h3 {
            color: white;
            font-size: 1.8em;
            margin-bottom: 20px;
        }

        .info-card ul {
            color: rgba(255, 255, 255, 0.9);
            font-size: 1.1em;
            line-height: 2;
            list-style: none;
            padding: 0;
        }

        .info-card ul li {
            margin-bottom: 10px;
        }

        /* Responsive */
        @media (max-width: 1200px) {
            .probabilities-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 768px) {
            h1 { font-size: 2.5em; }
            .images-grid {
                grid-template-columns: 1fr;
            }
            .probabilities-grid {
                grid-template-columns: 1fr;
            }
            .stats-bar {
                flex-direction: column;
            }
        }

        @keyframes scaleIn {
            to { transform: scale(1); }
        }
    </style>
</head>
<body>
    <!-- Particle Background -->
    <div id="particles"></div>

    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>üß¨ AI OCT ANALYZER</h1>
            <p class="subtitle">NEXT-GEN RETINAL DISEASE DETECTION SYSTEM</p>
        </div>

        <!-- Stats Bar -->
        <div class="stats-bar">
            <div class="stat-card">
                <div class="stat-number" id="accuracy">0</div>
                <div class="stat-label">Model Accuracy %</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="avgTime">0</div>
                <div class="stat-label">Avg Processing Time (s)</div>
            </div>
        </div>

        <!-- Upload Zone -->
        <div class="upload-zone" onclick="document.getElementById('fileInput').click()">
            <div class="upload-content">
                <div class="upload-icon">üî¨</div>
                <div class="upload-text">UPLOAD OCT SCAN</div>
                <p style="color: rgba(255,255,255,0.7); margin-bottom: 25px;">
                    Click or drag and drop your medical image
                </p>
                <input type="file" id="fileInput" accept="image/*" style="display: none;" onchange="uploadImage()">
                <button class="upload-btn">CHOOSE FILE</button>
            </div>
        </div>

        <!-- Loading Animation -->
        <div class="loading" id="loading">
            <div class="dna-helix">
                <div class="dna-strand"></div>
                <div class="dna-strand"></div>
                <div class="dna-strand"></div>
                <div class="dna-strand"></div>
                <div class="dna-strand"></div>
            </div>
            <div class="loading-text">ANALYZING RETINAL SCAN...</div>
            <p style="color: rgba(255,255,255,0.6); margin-top: 15px;">
                Extracting 1286 deep features ‚Ä¢ Running neural network
            </p>
        </div>

        <!-- Results -->
        <div class="results" id="results">
            <!-- Speedometer -->
            <div class="speedometer-section">
                <h2 class="speedometer-title">PREDICTION CONFIDENCE</h2>
                <div class="speedometer">
                    <svg class="gauge-svg" viewBox="0 0 200 100">
                        <defs>
                            <linearGradient id="gradient" x1="0%" y1="0%" x2="100%" y2="0%">
                                <stop offset="0%" style="stop-color:#5761B2;stop-opacity:1" />
                                <stop offset="50%" style="stop-color:#3B9FB5;stop-opacity:1" />
                                <stop offset="100%" style="stop-color:#1FC5A8;stop-opacity:1" />
                            </linearGradient>
                        </defs>
                        <path class="gauge-bg" d="M 20,90 A 80,80 0 0,1 180,90" />
                        <path class="gauge-progress" id="gaugeProgress" 
                              d="M 20,90 A 80,80 0 0,1 180,90"
                              stroke-dasharray="251.2"
                              stroke-dashoffset="251.2" />
                    </svg>
                    <div class="needle" id="needle"></div>
                    <div class="needle-center"></div>
                </div>
                <div class="confidence-display">
                    <div class="confidence-number" id="confidenceValue">0%</div>
                    <div class="prediction-badge" id="predictionBadge">ANALYZING</div>
                </div>
            </div>

            <!-- Images -->
            <h2 class="section-title">IMAGE ANALYSIS</h2>
            <div class="images-grid">
                <div class="image-card-3d">
                    <img id="originalImg" src="" alt="Original">
                    <div class="image-card-title">üì∏ Original Scan</div>
                    <div class="image-card-desc">Raw OCT imaging data</div>
                </div>
                <div class="image-card-3d">
                    <img id="enhancedImg" src="" alt="Enhanced">
                    <div class="image-card-title">‚ú® Enhanced Image</div>
                    <div class="image-card-desc">CLAHE preprocessing applied</div>
                </div>
                <div class="image-card-3d">
                    <img id="heatmapImg" src="" alt="Heatmap">
                    <div class="image-card-title">üî• Attention Map</div>
                    <div class="image-card-desc">AI focus regions</div>
                </div>
            </div>

            <!-- Circular Probabilities -->
            <h2 class="section-title">DISEASE CLASSIFICATION</h2>
            <div class="probabilities-grid" id="probabilitiesGrid"></div>

            <!-- Features -->
            <h2 class="section-title">TEXTURE FEATURES (GLCM)</h2>
            <div class="features-section" id="featuresSection"></div>

            <!-- Medical Insights -->
            <div id="medicalInsights" style="display: none; margin-top: 60px;">
                <h2 class="section-title">MEDICAL INSIGHTS</h2>
                
                <!-- Disease Overview Card -->
                <div class="medical-card">
                    <div style="display: flex; align-items: center; margin-bottom: 30px;">
                        <div id="diseaseIcon" style="font-size: 4em; margin-right: 30px;">üè•</div>
                        <div>
                            <h2 id="diseaseName" style="color: white; font-size: 2.5em; font-weight: 700; margin-bottom: 10px;"></h2>
                            <div id="urgencyBadge" style="display: inline-block; padding: 10px 25px; border-radius: 20px; font-weight: 600; font-size: 1.1em;"></div>
                        </div>
                    </div>
                    
                    <p id="diseaseDesc" style="color: rgba(255, 255, 255, 0.9); font-size: 1.3em; line-height: 1.8; margin-bottom: 20px;"></p>
                    
                    <div id="riskIndicator" style="margin-top: 30px; padding: 20px; border-radius: 15px; font-size: 1.2em; font-weight: 600;"></div>
                </div>

                <!-- Information Grid -->
                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 30px; margin-bottom: 40px;">
                    <!-- Symptoms -->
                    <div class="info-card" style="background: rgba(255, 107, 107, 0.2); border: 1px solid rgba(255, 107, 107, 0.3);">
                        <h3>‚ö†Ô∏è Symptoms</h3>
                        <ul id="symptomsList"></ul>
                    </div>

                    <!-- Causes -->
                    <div class="info-card" style="background: rgba(87, 97, 178, 0.2); border: 1px solid rgba(87, 97, 178, 0.3);">
                        <h3>üîç Common Causes</h3>
                        <ul id="causesList"></ul>
                    </div>

                    <!-- Treatment -->
                    <div class="info-card" style="background: rgba(31, 197, 168, 0.2); border: 1px solid rgba(31, 197, 168, 0.3);">
                        <h3>üíä Treatment Options</h3>
                        <ul id="treatmentList"></ul>
                    </div>

                    <!-- Lifestyle -->
                    <div class="info-card" style="background: rgba(59, 159, 181, 0.2); border: 1px solid rgba(59, 159, 181, 0.3);">
                        <h3>üõ°Ô∏è Lifestyle Changes</h3>
                        <ul id="lifestyleList"></ul>
                    </div>
                </div>

                <!-- Prognosis Banner -->
                <div style="background: var(--gradient-main); backdrop-filter: blur(15px); border-radius: 20px; padding: 40px; text-align: center; border: 1px solid rgba(255, 255, 255, 0.2);">
                    <h3 style="color: white; font-size: 1.6em; margin-bottom: 15px;">üìä Prognosis</h3>
                    <p id="prognosisText" style="color: rgba(255, 255, 255, 0.95); font-size: 1.3em; line-height: 1.8;"></p>
                </div>

                <!-- Disclaimer -->
                <div style="margin-top: 40px; padding: 30px; background: rgba(255, 255, 255, 0.08); border-radius: 15px; border-left: 4px solid #1FC5A8;">
                    <p style="color: rgba(255, 255, 255, 0.8); font-size: 1em; line-height: 1.6;">
                        ‚ö†Ô∏è <strong>Medical Disclaimer:</strong> This AI analysis is for educational purposes only and should not replace professional medical advice. 
                        Always consult with a qualified ophthalmologist for diagnosis and treatment decisions.
                    </p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Initialize particles
        function createParticles() {
            const container = document.getElementById('particles');
            for (let i = 0; i < 50; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 20 + 's';
                particle.style.animationDuration = (15 + Math.random() * 10) + 's';
                container.appendChild(particle);
            }
        }
        createParticles();

        // Animate stats on load
        function animateStats() {
            animateValue('accuracy', 0, 94, 2000);
            animateValue('avgTime', 0, 3.2, 2000, 1);
        }
        animateStats();

        function uploadImage() {
            const fileInput = document.getElementById('fileInput');
            const file = fileInput.files[0];
            
            if (!file) return;

            // Show loading
            document.getElementById('loading').style.display = 'block';
            document.getElementById('results').style.display = 'none';

            const formData = new FormData();
            formData.append('file', file);

            fetch('/predict', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    setTimeout(() => displayResults(data), 1000);
                } else {
                    alert('Error: ' + data.error);
                }
                document.getElementById('loading').style.display = 'none';
            })
            .catch(error => {
                alert('Error: ' + error);
                document.getElementById('loading').style.display = 'none';
            });
        }

        function displayResults(data) {
            document.getElementById('results').style.display = 'block';
            window.scrollTo({ top: document.getElementById('results').offsetTop - 100, behavior: 'smooth' });

            const confidence = data.confidence;

            // Speedometer
            const angle = (confidence / 100) * 180 - 90;
            document.getElementById('needle').style.transform = `translateX(-50%) rotate(${angle}deg)`;
            
            // Gauge progress
            const gaugeProgress = document.getElementById('gaugeProgress');
            const circumference = 251.2;
            const offset = circumference - (confidence / 100) * circumference;
            gaugeProgress.style.strokeDashoffset = offset;

            // Animate confidence
            animateValue('confidenceValue', 0, confidence, 2000, 0, '%');

            // Prediction badge
            document.getElementById('predictionBadge').textContent = data.predicted_class;

            // Images
            document.getElementById('originalImg').src = 'data:image/png;base64,' + data.images.original;
            document.getElementById('enhancedImg').src = 'data:image/png;base64,' + data.images.enhanced;
            document.getElementById('heatmapImg').src = 'data:image/png;base64,' + data.images.heatmap;

            // Circular probabilities
            const colors = ['#5761B2', '#3B9FB5', '#1FC5A8', '#26D0B8'];
            const probGrid = document.getElementById('probabilitiesGrid');
            probGrid.innerHTML = '';
            
            Object.entries(data.all_probabilities).forEach(([cls, prob], index) => {
                const color = colors[index];
                const circle = document.createElement('div');
                circle.className = 'prob-circle';
                circle.innerHTML = `
                    <div class="circle-container">
                        <svg width="200" height="200">
                            <circle class="circle-bg" cx="100" cy="100" r="80"/>
                            <circle class="circle-progress" cx="100" cy="100" r="80"
                                    stroke="${color}"
                                    stroke-dasharray="502.4"
                                    stroke-dashoffset="502.4"
                                    transform="rotate(-90 100 100)"
                                    id="circle-${index}"/>
                        </svg>
                        <div class="circle-text">
                            <div class="circle-percentage" id="percent-${index}">0%</div>
                        </div>
                    </div>
                    <div class="circle-label">${cls}</div>
                `;
                probGrid.appendChild(circle);

                // Animate circle
                setTimeout(() => {
                    const circumference = 502.4;
                    const offset = circumference - (prob / 100) * circumference;
                    document.getElementById(`circle-${index}`).style.strokeDashoffset = offset;
                    animateValue(`percent-${index}`, 0, prob, 1500, 1, '%');
                }, 100 * index);
            });

            // Feature bars
            const featuresSection = document.getElementById('featuresSection');
            featuresSection.innerHTML = '';
            const featureColors = [
                'linear-gradient(90deg, #5761B2, #3B9FB5)',
                'linear-gradient(90deg, #3B9FB5, #1FC5A8)',
                'linear-gradient(90deg, #1FC5A8, #26D0B8)',
                'linear-gradient(90deg, #26D0B8, #1FC5A8)',
                'linear-gradient(90deg, #1FC5A8, #3B9FB5)',
                'linear-gradient(90deg, #3B9FB5, #5761B2)'
            ];
            
            Object.entries(data.glcm_features).forEach(([name, value], index) => {
                const maxVal = 300;
                const percentage = Math.min((value / maxVal) * 100, 100);
                
                const feature = document.createElement('div');
                feature.className = 'feature-item';
                feature.innerHTML = `
                    <div class="feature-header">
                        <span class="feature-name">${name}</span>
                        <span class="feature-value">${value.toFixed(4)}</span>
                    </div>
                    <div class="feature-bar-container">
                        <div class="feature-bar-fill" style="width: ${percentage}%; background: ${featureColors[index]}"></div>
                    </div>
                `;
                featuresSection.appendChild(feature);
            });

            // Medical Insights
            displayMedicalInsights(data);
        }

        function displayMedicalInsights(data) {
            const diseaseInfo = data.disease_info;
            const severityInfo = data.severity_info;
            
            document.getElementById('medicalInsights').style.display = 'block';

            // Disease name and description
            document.getElementById('diseaseName').textContent = diseaseInfo.name;
            document.getElementById('diseaseDesc').textContent = diseaseInfo.description;

            // Urgency badge with dynamic severity
            const urgencyBadge = document.getElementById('urgencyBadge');
            urgencyBadge.textContent = severityInfo.urgency;
            urgencyBadge.style.background = severityInfo.color;
            urgencyBadge.style.color = 'white';

            // Risk indicator with severity info
            const riskIndicator = document.getElementById('riskIndicator');
            const riskScore = severityInfo.risk_score;
            riskIndicator.innerHTML = `
                <div style="margin-bottom: 15px;">Severity: ${severityInfo.level}</div>
                <div style="font-size: 1em; font-weight: 400; margin-bottom: 15px;">${severityInfo.description}</div>
                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                    <span style="color: white; font-weight: 600;">Risk Score</span>
                    <span style="color: white; font-weight: 700;">${riskScore}/100</span>
                </div>
                <div style="height: 15px; background: rgba(255,255,255,0.2); border-radius: 10px; overflow: hidden;">
                    <div style="height: 100%; width: ${riskScore}%; background: ${severityInfo.color}; transition: width 1.5s;"></div>
                </div>
            `;
            riskIndicator.style.background = severityInfo.color + '33';
            riskIndicator.style.border = `2px solid ${severityInfo.color}`;
            riskIndicator.style.color = 'white';

            // Populate lists
            function populateList(elementId, items) {
                const list = document.getElementById(elementId);
                list.innerHTML = items.map(item => `<li>‚úì ${item}</li>`).join('');
            }

            populateList('symptomsList', diseaseInfo.symptoms);
            populateList('causesList', diseaseInfo.causes);
            populateList('treatmentList', diseaseInfo.treatment);
            populateList('lifestyleList', diseaseInfo.lifestyle);

            // Prognosis
            document.getElementById('prognosisText').textContent = diseaseInfo.prognosis;

            // Smooth scroll to insights
            setTimeout(() => {
                document.getElementById('medicalInsights').scrollIntoView({ behavior: 'smooth', block: 'start' });
            }, 1000);
        }

        function animateValue(id, start, end, duration, decimals = 0, suffix = '') {
            const element = document.getElementById(id);
            const range = end - start;
            const startTime = performance.now();

            function update(currentTime) {
                const elapsed = currentTime - startTime;
                const progress = Math.min(elapsed / duration, 1);
                const easeProgress = 1 - Math.pow(1 - progress, 3);
                const value = start + (range * easeProgress);
                element.textContent = value.toFixed(decimals) + suffix;

                if (progress < 1) {
                    requestAnimationFrame(update);
                }
            }

            requestAnimationFrame(update);
        }
    </script>
</body>
</html>
